[
  {
    "path": "portfolio/2022-03-01-data-visualization-mono-lake-water-levels-from-1850-2017/",
    "title": "Data Visualization: Mono Lake Water Levels from 1850 - 2017",
    "description": "This code wrangles data relating to Mono Lake water levels from 1850 to 2017.",
    "author": [
      {
        "name": "Taylor Gries",
        "url": {}
      }
    ],
    "date": "2022-03-01",
    "categories": [],
    "contents": "\n\n\nhide\n\n# Load in packages\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(GGally)\nlibrary(kableExtra)\nlibrary(modelsummary)\nlibrary(stargazer)\nlibrary(effsize)\n\n\n\n\n\nhide\n\nggplot(data = mono_lake_clean, aes(x = year, y = lake_level_feet_above_sea_level)) + # Create line graph\n  geom_line(color = \"darkblue\", \n            size = 0.4) + # Change color and size of lake level data\n  scale_x_continuous(limits = c(1850, 2020),\n                     expand = c(0,0),\n                     breaks = seq(1850, 2020, by = 25)) + # Fix x grid\n  scale_y_continuous(limits = c(6372, 6428),\n                     expand = c(0,0),\n                     breaks = seq(6370, 6430, by = 10)) + # Fix y grid\n  theme_minimal() + # Change theme \n  labs(x = \"Year\", # Add in plot labels\n       y = \"Water Level (Ft above Sea Level)\",\n       title = \"Annual Mono Lake Water Levels: 1850 - 2017\",\n       caption = \"Data: Mono Basin Clearinghouse\") +\n  theme(axis.title.x = element_text(size = 10, # Edit text \n                                    hjust = 0.5),\n        axis.title.y = element_text(size = 10, \n                                    hjust = 0.5),\n        plot.title = element_text(size = 14, \n                                  hjust = 0.5)) +\n    geom_hline(yintercept = 6392, # Add in stable water level line\n               linetype = \"solid\", \n               color = \"darkgreen\",\n               size = 0.5) +\n  geom_text(x = 1852, y = 6390, # Add in stable water level text\n            label = \"Stable Lake Level at 6,392 ft\",\n            color = \"darkgreen\",\n            size = 3,\n            hjust = 0,\n            vjust = 0.5) +\n  geom_hline(yintercept = 6377, # Add in Land Bridge line\n             linetype = \"dashed\",\n             color = \"darkred\",\n             size = 0.5) +\n  geom_text(x = 1852, y = 6375, \n            label = \"Land Bridges Emerge at 6,377 ft\", # Add in Land Bridge text\n            color = \"darkred\",\n            size = 3,\n            hjust = 0,\n            vjust = 0.5) +\n  annotate(\"text\", label = \"1941: LA DWP Begins Diverting Water\", # Add in historical event text\n           x = 1950,\n           y = 6420,\n           size = 2.5,\n           vjust = 0,\n           hjust = 0.15) +\n  geom_point(aes(x = 1941, y = 6417), # Add in point for historical event\n             size = 1) +\n  annotate(\"text\", label = \"1976: First Ecological Study\", # Add in historical event text\n           x = 1965,\n           y = 6380,\n           size = 2.5,\n           vjust = .1,\n           hjust = .8) +\n  geom_point(aes(x = 1976, y = 6378), # Add in point for historical event\n             size = 1) +\n  annotate(\"text\", label = \"1998: State Issued Restoration Orders\", # Add in historical event text\n           x = 1995,\n           y = 6388,\n           size = 2.5,\n           vjust = .2,\n           hjust = .45) +\n  geom_point(aes(x = 1998, y = 6384.4), # Add in point for historical event\n             size = 1)\n\n\n\n\nFigure 1: Mono Lake levels have plumented since 1941\nin a 40 year time span due to the Los Angeles Department of Water &\nPower (DWP) diverting water, causing the lake to los half its volume and\ndoubling in salinity. Once students discovered the ecological collapse\nin 1976, action has been taken to decrease land bridges causing a\ndecline in bird nesting sites and to increase food resources for aquatic\nbirds.\n\n\n\n",
    "preview": "portfolio/2022-03-01-data-visualization-mono-lake-water-levels-from-1850-2017/data-visualization-mono-lake-water-levels-from-1850-2017_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-03-01T14:29:09-08:00",
    "input_file": {}
  },
  {
    "path": "portfolio/2022-03-01-environmental-strategy-group-project/",
    "title": "Environmental Strategy Group Project",
    "description": "In this assignment, five MESM students were randomly assigned to a team to create an environmental strategy for a specific sustainability initiative. The team brainstormed an idea, researched the company and environmental problem, and wrote the complete report over four weeks. The assignment was completed purely for educational purposes for ESM 210: Business and the Environment.",
    "author": [
      {
        "name": "Taylor Gries",
        "url": {}
      }
    ],
    "date": "2022-03-01",
    "categories": [],
    "contents": "\nIn this assignment, five MESM students were randomly assigned to a\nteam to create an environmental strategy for a specific sustainability\ninitiative. The team brainstormed an idea, researched the company and\nenvironmental problem, and wrote the complete report over four weeks.\nThe assignment was completed purely for educational purposes for ESM\n210: Business and the Environment.\nclick\nhere for PDF of the report\n\n\n\n",
    "preview": {},
    "last_modified": "2022-03-01T14:55:12-08:00",
    "input_file": {}
  },
  {
    "path": "portfolio/2022-03-01-agglomerative-hierarchical-clustering/",
    "title": "Agglomerative Hierarchical Clustering",
    "description": "This code will use hierarchical clustering by complete linkage to create a dendrogram showing multivariate clustering for water chemistry by site.",
    "author": [
      {
        "name": "Taylor Gries",
        "url": {}
      }
    ],
    "date": "2022-03-01",
    "categories": [],
    "contents": "\nOverview\nThis code will use hierarchical clustering by complete linkage to\ncreate a dendrogram showing multivariate clustering for water chemistry\nby site. This data looks at Santa Barbara Coastal drainage are and has\nbeen ongoing since 2000.\nVariables\nTotal Dissolved Nitrogen uM\nTotal Dissolved Phosphorus uM\nTotal Particulate Carbon micromolesPerLiter\nTotal Particulate Nitrogen micromolesPerLiter\nTotal Suspended Solids (milligramPerLiter)\nData Citation: Santa Barbara Coastal LTER and J.\nMelack. 2019. SBC LTER: Land: Stream chemistry in the Santa Barbara\nCoastal drainage area, ongoing since 2000 ver 16. Environmental Data\nInitiative.\n\n\nhide\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(here)\nlibrary(naniar)\n \n# Packages for cluster analysis:\nlibrary(NbClust)\nlibrary(cluster)\nlibrary(factoextra)\nlibrary(dendextend)\nlibrary(ggdendro)\n\n\n\n\n\nhide\n\nstream_chem <- read_csv( \"sbc_lter_registered_stream_chemistry.csv\")\n\n\n\nData Wrangling\nTo perform hierarchical clustering by site, I made a data frame that\nhas a single summary row per site (e.g. based on means from all\nobservations at that site). Then, I calculated the Euclidean distance\nbefore performing complete linkage agglomerative hierarchical\nclustering.\n\n\nhide\n\nstream_chem_clean <- stream_chem %>%\n  na_if(-999) %>%\n  clean_names() %>%\n  group_by(site_code) %>%\n  select(site_code, nh4_u_m:spec_cond_u_spercm) %>%\n  summarize(\n    \"Ammonium\" = mean(nh4_u_m, na.rm = TRUE),\n    \"Nitrate\" = mean(no3_u_m, na.rm = TRUE),\n    \"Phosphorous\" = mean(po4_u_m, na.rm = TRUE),\n    \"Dissolved Nitrogen\" = mean(tdn_u_m, na.rm = TRUE),\n    \"Dissolved Phosphorous\" = mean(tdp_u_m, na.rm = TRUE),\n    \"Particulate Carbon\" = mean(tpc_u_m, na.rm = TRUE),\n    \"Particulate Nitrogen\" = mean(tpn_u_m, na.rm = TRUE),\n    \"Particulate Phosphorous\" = mean(tpp_u_m, na.rm = TRUE),\n    \"Suspended Solids\" = mean(tss_mgper_liter, na.rm = TRUE),\n    \"Specific Conductivity\" = mean(spec_cond_u_spercm, na.rm = TRUE))\n\n\n\n\n\nhide\n\nstream_chem_scale <- stream_chem_clean %>% \n  select(-site_code) %>%\n  scale() # See ?scale for details on scaling\n\n# compare scaled to original vars\nsummary(stream_chem_scale)\n\n\n    Ammonium           Nitrate          Phosphorous       \n Min.   :-0.73964   Min.   :-0.77508   Min.   :-1.253113  \n 1st Qu.:-0.43147   1st Qu.:-0.53141   1st Qu.:-0.840234  \n Median :-0.26219   Median :-0.38032   Median :-0.004647  \n Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.000000  \n 3rd Qu.: 0.08308   3rd Qu.: 0.01833   3rd Qu.: 0.344302  \n Max.   : 3.12885   Max.   : 2.69615   Max.   : 2.090693  \n                                                          \n Dissolved Nitrogen Dissolved Phosphorous Particulate Carbon\n Min.   :-0.86299   Min.   :-1.146829     Min.   :-0.6849   \n 1st Qu.:-0.40463   1st Qu.:-0.932105     1st Qu.:-0.5918   \n Median :-0.32968   Median : 0.009524     Median :-0.5082   \n Mean   : 0.00000   Mean   : 0.000000     Mean   : 0.0000   \n 3rd Qu.:-0.02608   3rd Qu.: 0.417142     3rd Qu.: 0.5352   \n Max.   : 2.99465   Max.   : 2.215888     Max.   : 2.2479   \n                                          NA's   :4         \n Particulate Nitrogen Particulate Phosphorous Suspended Solids  \n Min.   :-0.7090      Min.   :-0.61584        Min.   :-1.08381  \n 1st Qu.:-0.6308      1st Qu.:-0.60567        1st Qu.:-0.87579  \n Median :-0.5227      Median :-0.56597        Median : 0.06448  \n Mean   : 0.0000      Mean   : 0.00000        Mean   : 0.00000  \n 3rd Qu.: 0.5891      3rd Qu.:-0.02581        3rd Qu.: 0.37862  \n Max.   : 2.1037      Max.   : 2.20964        Max.   : 2.29779  \n NA's   :4            NA's   :4               NA's   :1         \n Specific Conductivity\n Min.   :-1.0191      \n 1st Qu.:-0.6732      \n Median :-0.1254      \n Mean   : 0.0000      \n 3rd Qu.: 0.2186      \n Max.   : 2.6730      \n                      \n\nDendrogram\nComplete Linkage\n\n\nhide\n\nrownames(stream_chem_scale) <- stream_chem_clean$site_code # adding rownames from original dataset\n\n\n\nFigure 1: A cluster dendrogram that illustrates\nwater chemistry by site using complete linkage - the clusters are merged\nby the smallest maximum distance between two\nobservations in distinct clusters. Data: Santa Barbara Coastal LTER\nand J. Melack. (2019)\n\n\nhide\n\nstream_chem_dist <- dist(stream_chem_scale, method = 'euclidean') \n\n# Hierarchical clustering (complete linkage)\nstream_hc_complete <- hclust(stream_chem_dist, method = \"complete\")\n\n\n# Pretty plot\nggdendrogram(stream_hc_complete, \n             rotate = TRUE) +\n  theme_minimal() +\n  labs(title = \"Water Chemistry by Site (Complete Linkage)\",\n       x = \"Stream Site\",\n       y = \"Height\",\n       caption = \"Data: Santa Barbara Coastal LTER and J. Melack (2019).\")\n\n\n\n\nSingle Linkage\nFigure 2: Cluster dendrogram for illustrating water\nchemistry by site using single linkage - the clusters are merged by the\nsmallest distance between observations in separate clusters.\nData: Santa Barbara Coastal LTER and J. Melack. (2019)\n\n\nhide\n\n# Hierarchical clustering (single linkage)\nstream_hc_single <- hclust(stream_chem_dist, method = \"single\")\n\n\n# Pretty plot\nggdendrogram(stream_hc_single, \n             rotate = TRUE) +\n  theme_minimal() +\n  labs(title = \"Water Chemistry by Site (Single Linkage)\",\n       x = \"Stream Site\",\n       y = \"Height\",\n       caption = \"Data: Santa Barbara Coastal LTER and J. Melack (2019).\")\n\n\n\n\nResults\nThere is a large mean concentration of Ammonium in stream 4\n(DV01) which is the largest grouping\nThere are 3 sites in one of these two sub-groupings that all have\nhigh Ammonium concentrations compared to other sites.\nSince 9 out of 13 sites fit into one sub-grouping, this could\nmean the variables are correlated in some way for most of the\nsites.\nAll other sites are included in a grouping with at least two\nsub-groupings.\nFurther investigation is needed for streams not included in the\nlarger sub-groups.\nCitations\nData Citation: Santa Barbara Coastal LTER and J.\nMelack. 2019. SBC LTER: Land: Stream chemistry in the Santa Barbara\nCoastal drainage area, ongoing since 2000 ver 16. Environmental Data\nInitiative.\n\n\n\n",
    "preview": "portfolio/2022-03-01-agglomerative-hierarchical-clustering/agglomerative-hierarchical-clustering_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-03-01T15:02:07-08:00",
    "input_file": "agglomerative-hierarchical-clustering.knit.md"
  },
  {
    "path": "portfolio/2022-02-20-binary-logistic-regression-report/",
    "title": "Binary Logistic Regression Report",
    "description": "This code uses binary logistic regression to test the feasibility of using various variables to classify whether a palmetto is species Serenoa repens or Sabal etonia. For ESM 244.",
    "author": [
      {
        "name": "Taylor Gries",
        "url": {}
      }
    ],
    "date": "2022-02-20",
    "categories": [],
    "contents": "\nOverview\nThis code uses binary logistic regression to test the feasibility of using variables plant height (height), canopy length (length), canopy width (width), and number of green leaves (green_lvs) to classify whether a palmetto is species Serenoa repens or Sabal etonia. Annual measures for Palmetto data included height, canopy length and width (all in cm), number of new and green leaves and flowering scapes. Data was collected continuously (not for all variables or sites) from 1981 through 1997 then again in 2001 and 2017. Data collection is ongoing at 5-year intervals.\nData source: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\n\n\nhide\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\nlibrary(purrr)\nlibrary(tidyverse)\nlibrary(Metrics)\nlibrary(cowplot)\nlibrary(here)\nlibrary(janitor)\nlibrary(broom)\nlibrary(ggbeeswarm)\nlibrary(stargazer)\nlibrary(kableExtra)\nlibrary(caret)\n\n\n\n\n\nhide\n\n# Read in the data\npalmetto <- read_csv(here(\"data\", \"palmetto.csv\"))\n\n\n\nData Wrangling\n\n\nhide\n\npalmetto_clean <- palmetto %>%\n  select(species, height, length, width, green_lvs) %>%\n  drop_na() %>% \n  mutate(species = case_when(species == \"1\" ~ \"Serenoa repens\",\n                   species == \"2\" ~ \"Sabal etonia\"))\n\n\n\nData Exploration and Visualization\n\n\nhide\n\nggplot(data = palmetto_clean, aes(x = height, y = width)) +\n  geom_point(aes(color = species)) +\n  theme_minimal() +\n  facet_wrap(~ species) +\n  scale_color_manual(values = c(\"light blue\", \"dark blue\")) +\n  labs(x = \"Plant Height (cm)\",\n       y = \"Canopy Width (cm)\",\n       title = \"Palmetto Height vs. Canopy Width (cm)\",\n       color = \"Species\")\n\n\n\n\nFigure 1. Exploratory plot comparing the relationship between palmetto height (cm) and canopy width (cm) by species. Data: Abrahamson (2019).\nFor both palmetto species, plant height appears to increase with an increase in canopy width.\n\n\nhide\n\nggplot(data = palmetto_clean, aes(x = green_lvs, y = height)) +\n  geom_point(aes(color = species)) +\n  theme_minimal() +\n  facet_wrap(~ species) +\n  scale_color_manual(values = c(\"light blue\", \"dark blue\")) +\n  labs(x = \"Green Leaf Count\",\n       y = \"Plant Height (cm)\",\n       title = \"Palmetto Height vs. Green Leaf Count\",\n       color = \"Species\")\n\n\n\n\nFigure 2. Exploratory plot comparing the relationship between the number of green leaves observed and palmetto height (cm) for each species. Data: Abrahamson (2019).\nThe number of green leaves on a palmetto plant increases with an increase in plant height. The Sabal etonia species has a smaller range of 0 - 10 leaves. The Serenoa repens species has a greater range of number of green leaves, from 1 - 15 leaves.\n\n\nhide\n\nggplot(data = palmetto_clean, aes(x = species, y = height)) +\n  geom_jitter(aes(color = species,\n                  alpha = 0.4)) +\n  theme_minimal() +\n  scale_color_manual(values = c(\"light blue\", \"dark blue\")) +\n  geom_boxplot(fill = NA, \n               width = 0.8) +\n  stat_summary(fun=mean, \n               geom=\"point\", \n               shape=18, \n               size=3, \n               color=\"black\", \n               fill=\"black\") +\n  labs(x = \"Palmetto Species\",\n       y = \"Palmetto Height (cm)\",\n       title = \"Palmetto Height (cm) vs Species\") +\n  theme(legend.position = \"none\")\n\n\n\n\nFigure 3. Comparison between palmetto species Serenoa repens and Sabal etonia and the plant height (cm). The bolded black line indicates the median value and the black point within the box indicates the mean value for each species; the black points at either end of the vertical lines indicates outliers. Data: Abrahamson (2019).\nSerenoa repens species has a slightly greater mean and median plant height, as well as a larger range, than that of the Sabal etonia species.\nBinary Logistic Regression\nModel 1\n\n\nhide\n\npalmetto_species <- palmetto_clean %>%\n  drop_na() %>% \n  mutate(species = as.factor(species)) %>% \n  mutate(species = fct_drop(species))\n\n# Code 1 (Serenoa repens) is the '0' level\n\n# Check the levels\n\n# levels(palmetto_species$species)\n\n# Binary Logistic Regression\npalmetto_blr1 <- glm(species ~ height + length + width + green_lvs, \n                            data = palmetto_species, \n                            family = \"binomial\")\n\n# Look at the model\n# palmetto_blr1\n\n\n# summary(palmetto_blr1)\n\n# Get a tidy version w/ broom: \npalmetto_blr1_tidy <- broom::tidy(palmetto_blr1)\n\n\n\nTable 1. The results of the binary logistic regression model that predicts the probability of a palmetto plant being Sabal etonia or Serenoa repens, based off the predictor variables: plant height, canopy length, canopy width, and the number of green leaves. Coefficients, standard errors (in parentheses), and significance information are indicated for each predictor variable based on the dependent variable (Sabal etonia species). Data: Abrahamson (2019).\n\n\nhide\n\nstargazer(palmetto_blr1, type = \"text\",\n          title = \"Table 1: Binary Logistic Regression Results - Model 1\",\n          dep.var.labels = \"Species: Sabal etonia\",\n          covariate.labels = c(\"Height\", \"Length\", \"Width\", \"Green leaf count\"))\n\n\n\nTable 1: Binary Logistic Regression Results - Model 1\n=============================================\n                      Dependent variable:    \n                  ---------------------------\n                     Species: Sabal etonia   \n---------------------------------------------\nHeight                     0.029***          \n                            (0.002)          \n                                             \nLength                     -0.046***         \n                            (0.002)          \n                                             \nWidth                      -0.039***         \n                            (0.002)          \n                                             \nGreen leaf count           1.908***          \n                            (0.039)          \n                                             \nConstant                   -3.227***         \n                            (0.142)          \n                                             \n---------------------------------------------\nObservations                12,267           \nLog Likelihood            -2,592.281         \nAkaike Inf. Crit.          5,194.562         \n=============================================\nNote:             *p<0.1; **p<0.05; ***p<0.01\n\nModel 2\nTable 2: The results of the binary logistic regression model that predicts the probability of a palmetto plant being Sabal etonia or Serenoa repens, based off the predictor variables: plant height, canopy width, and the number of green leaves. Coefficients, standard errors (in parentheses), and significance information are indicated for each predictor variable based on the dependent variable (Sabal etonia species). Data: Abrahamson (2019).\n\n\nhide\n\n# Binary Logistic Regression\npalmetto_blr2 <- glm(species ~ height + width + green_lvs, \n                            data = palmetto_species, \n                            family = \"binomial\")\n\n# Look at the model\n# palmetto_blr2\n\n# summary(palmetto_blr2)\n\n# Get a tidy version w/ broom: \npalmetto_blr2_tidy <- broom::tidy(palmetto_blr2)\n\n\n\n\n\nhide\n\nstargazer(palmetto_blr2, type = \"text\",\n          title = \"Table 2: Binary Logistic Regression Results - Model 2\",\n          dep.var.labels = \"Species: Sabal etonia\",\n          covariate.labels = c(\"Height\", \"Width\", \"Green leaf count\"))\n\n\n\nTable 2: Binary Logistic Regression Results - Model 2\n=============================================\n                      Dependent variable:    \n                  ---------------------------\n                     Species: Sabal etonia   \n---------------------------------------------\nHeight                       0.003           \n                            (0.002)          \n                                             \nWidth                      -0.069***         \n                            (0.002)          \n                                             \nGreen leaf count           1.885***          \n                            (0.036)          \n                                             \nConstant                   -3.768***         \n                            (0.135)          \n                                             \n---------------------------------------------\nObservations                12,267           \nLog Likelihood            -2,989.736         \nAkaike Inf. Crit.          5,987.472         \n=============================================\nNote:             *p<0.1; **p<0.05; ***p<0.01\n\nResults\n\n\nhide\n\nAIC <- AICcmodavg::aictab(list(palmetto_blr1, palmetto_blr2))\n\n\n\nAICc for Model 1 (plant height, canopy length, canopy width and green leaves) is 5194.57\nAICc for Model 2 (plant height, canopy width and green leaves) is 5987.48\nModel 1 has a lower AIC value so we anticipate that model 1 will be the better model than model 2.\n\n\nhide\n\n# model 1\nset.seed(100) \n\ntr_ctrl <- trainControl(method = \"repeatedcv\",\n                        number = 10, repeats = 10)\n \n# Train model 1\nmodel1 <- train(species ~ height + length + width + green_lvs,\n                data = palmetto_species,\n                method = \"glm\", family = 'binomial',\n                trControl = tr_ctrl)\n\n \n# Train model 2\nmodel2 <- train(species ~ height + width + green_lvs, data = palmetto_species,\n               method = \"glm\", family = 'binomial',\n               trControl = tr_ctrl)\n\n\n\nResults: Model 1 predicts the species of Palmetto with 91.7 % accuracy. This is slightly greater than the 89.9 percent predictive accuracy of Model 2. The AIC value for Model 2 (5987.48) is greater than model 1 (5194.57). Given the more favorable AIC value and small reduction in predictive accuracy, this analysis will use Model 1.\nTable 3: A table containing the number of palmetto plants in the original dataset correctly and incorrectly classified as their species by the binary logistic regression model. The percent correctly classified is displayed for each species. Data: Abrahamson (2019).\n\n\nhide\n\n# convert to probabilities\n\nblr_fitted <- palmetto_blr1 %>% \n  augment(data = palmetto_species, type.predict = \"response\") %>% \n  mutate(predicted = ifelse(.fitted >= .5, \"Serenoa repens\", \"Sabal etonia\")) %>% \n  mutate(correct = ifelse(predicted == species, \"predicted_correctly\", \"predicted_incorrectly\"))\n\npalmetto_table <- blr_fitted %>% \n  count(species, correct) %>% \n  pivot_wider(names_from = correct, values_from = n) %>% \n  mutate(total = rowSums(across(where(is.numeric)))) %>%\n  mutate(percent = (predicted_correctly / total)* 100) %>%\n  mutate_if(is.numeric,funs(as.character(signif(.,3))))\n\nkableExtra::kable(palmetto_table,\n                  col.names= c(\"Species\", \"Correct Prediction\",\n                               \"Incorrect Prediction\", \"Total\", \"% Correct\")) %>% \n    kableExtra::kable_styling(bootstrap_options = \"striped\",\n                            full_width = F,\n                            position =\"center\") %>% \n  kableExtra::add_header_above(bold = TRUE,\n                               line = TRUE,\n                               c(\"Percent species predicted correctly by binary logistic regression model 1\" = 5))\n\n\n\n\nPercent species predicted correctly by binary logistic regression model 1\n\n\n\nSpecies\n\n\nCorrect Prediction\n\n\nIncorrect Prediction\n\n\nTotal\n\n\n% Correct\n\n\nSabal etonia\n\n\n5700\n\n\n454\n\n\n6160\n\n\n92.6\n\n\nSerenoa repens\n\n\n5550\n\n\n564\n\n\n6110\n\n\n90.8\n\n\nModel 1 (plant height, canopy length, canopy width and green leaves) is very effective at classifying a plant as either Sabal etonia (92.6%, n = 6160) and Serenoa repens (90.8%, n = 6110).\nData Citation\nData source: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\n\n\n\n",
    "preview": "portfolio/2022-02-20-binary-logistic-regression-report/binary-logistic-regression-report_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-02-20T18:30:47-08:00",
    "input_file": {}
  },
  {
    "path": "portfolio/2022-02-20-juvenile-snowshoe-hares-in-bonanza-creek-experimental-forest-report/",
    "title": "Juvenile Snowshoe Hares in Bonanza Creek Experimental Forest Report",
    "description": "This report provides an exploratory overview of the differences in juvenile Snowshoe hares in Bonanza Creek Experimental Forest. For ESM 206.",
    "author": [
      {
        "name": "Taylor Gries",
        "url": {}
      }
    ],
    "date": "2022-02-20",
    "categories": [],
    "contents": "\n1. Overview\nThis report provides an exploratory overview of the differences in juvenile Snowshoe hares in Bonanza Creek Experimental Forest through exploring annual hare trap counts between 1999 and 2012 and female and male juvenile hare weights in the following grids: Bonanza Riparian, Bonanza Mature, and Bonbs. This report also explores the relationship between juvenile hare weight and hind foot length. Bonanza Creek LTER is part of the US Long Term Ecological Research Network. The Bonanza Creek Experimental Forest (BCEF) was established in 1963 is a 50 km^2 experimental forest located approximately 20 km southwest of Fairbanks, Alaska (Kielland et al. 2017). Through data wrangling, data visualization, test sampling, summary statistics, and regression calculation, this report provides an exploratory analysis of juvenile Snowshoe hares.\n2. Data and methods\nKnut Kielland, Stuart F. Chapin, and Roger W. Ruess conducted capture-recapture studies of snowshoe hares at 5 locales in the Tanana Valley, from Tok in the east to Clear in the west from 1999 to 2012. The data contain observations for adult and juvenile Snowshoe hares (Lepus americanus) (Kielland et al. 2017). The initial investigation began with visualizing annual juvenile snowshoe hare traps to understand the population size, maximum and minimum counts, mean, and general trends. There is a general downwards trend in the number of juvenile hare trappings, especially between the years 2000 - 2001. This report also explores juvenile hare weights by sex and grid by finding the mean, standard deviation, and sample size. Weight between female and male hares was compared by two-sample t-tests using a significance level (\\(\\alpha\\)) of 0.05. Linear regression explored the relationship between hare weight and hind foot length. All analyses are in R version 4.0.2 using RStudio version 1.3.1056.\n\n\nhide\n\n# Attach packages\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(lubridate)\nlibrary(broom)\nlibrary(effsize)\nlibrary(broom)\nlibrary(kableExtra)\nlibrary(ggbeeswarm)\n\n\n\n3. Preliminary results\nA. Juvenile Snoeshow hare initial investigation\n\n\nhide\n\n# Read in data\nbonanza_hares <- read_csv(here(\"data\", \"bonanza_hares.csv\"))\n\n\n\n\n\nhide\n\nbonanza_hares_count <- bonanza_hares %>% # Clean and wrangle data\n  filter (age == \"j\") %>%\n  mutate(date_new = mdy(date)) %>%\n  mutate(year = year(date_new)) %>%\n  group_by(year) %>%\n  count(year)\n\n# Create graph\nggplot(data = bonanza_hares_count, aes(x = year, y = n)) +\n  geom_col(color = \"gray20\",\n           fill = \"salmon1\",\n           stat = \"identity\",\n           bins = 15) +\n  theme_minimal() +\n  labs(x = \"Year\",\n       y = \"Number of Hare Traps\") +\n  theme(plot.title = element_text(color = \"gray20\", face = \"bold\", hjust = 0.5),\n        axis.title.x = element_text(color = \"gray20\", face = \"bold\"),\n        axis.title.y = element_text(color = \"gray20\", face = \"bold\")) +\n  scale_x_continuous(breaks = 1999:2012)\n\n\n\n\nFigure 1: Count of annual juvenile hare traps from 1999 to 2002 at Bonanza Creek LTER from Kielland, K., et al, (2017).\n\n\nhide\n\nharecount_min <- min(bonanza_hares_count$n) # Find min\n\nharecount_max <- max(bonanza_hares_count$n) # Find max\n\nharecount_mean <- mean(bonanza_hares_count$n) # Find mean\n\n\n\nThe minimum counts of juvenile hare trappings is 2 and the maximum count is 126. The mean juvenile hare trappings count is 31.5. There is a general downwards trends in the number of juvenile hare trappings, especially between the years 2000 - 2001. No hares were trapped in 2002 and 2009. It would be recommended to standardize the trapping collection process to ensure accurate data.\nB. Visualize juvenile Snowshoe hare weights\n\n\nhide\n\n# Clean and wrangle data\nbonanza_hares_weights <- bonanza_hares %>%\n  filter (age == \"j\") %>%\n  mutate(sex_full = case_when(\n    sex == \"m\" ~ \"Male\",\n    sex == \"f\" ~ \"Female\",\n    sex == \"NA\" ~ \"Not Available\")) %>%\n  mutate(grid_full = case_when(\n    grid == \"bonrip\" ~ \"Bonanza Riparian\",\n    grid == \"bonbs\" ~ \"Bonbs\",\n    grid == \"bonmat\" ~ \"Bonanza Mature\",\n  )) %>%\n  select(sex_full, weight, grid_full)\n\n# Graph data\nggplot(data = bonanza_hares_weights, aes(x = sex_full, y = weight)) +\n  geom_beeswarm(aes(color = sex_full), width = 3) +\n  facet_grid(~ grid_full) +\n  scale_color_manual(values = c(\"violetred\", \"cadetblue\", \"gray55\")) +\n  geom_boxplot(fill = NA, width = .3, outlier.color = NA) +\n  stat_summary(fun = mean,\n               geom = \"point\",\n               shape = 18,\n               size = 4,\n               color = \"black\",\n               fill = \"black\") +\n  theme_minimal() +\n  labs(x = \"Hare Sex\",\n       y = \"Hare Weight (g)\",\n       color = \"Sex\") +\n   theme(axis.title.x = element_blank(),\n        axis.title.y = element_text(face = \"italic\"))\n\n\n\n\nFigure 2: Juvenile Snowshoe hare weights by sex at Bonanza Riparian, Bonanza Mature, and Bonbs in Bonanza Creek LTER from Kielland, K., et al, (2017).\nFigure 2 is communicating how the sex of the hare and the location affects hare weights. From this visualization, it appears that sex does not have an impact on weights in juvenile hares since the means are similar for male and female hares. The visualization also shows that there is more data in the Bonanza Riparian grid vs the Bonbs grid, and that sex was not recorded for all data points.\nC. Juvenile Snowshoe hare weight comparison\nTable 1: Descriptive statistics (mean, standard deviation, and sample size) for juvenile hares by sex in Bonanza Creek LTER from Kielland, K., et al, (2017).\n\n\nhide\n\n# Clean data and pull in stats\nbonanza_hares_weights_summary <- bonanza_hares_weights %>%\n  group_by(sex_full) %>%\n  summarize(mean_size = round(mean(weight, na.rm = TRUE), 1),\n            median = round(median(weight, na.rm = TRUE), 2),\n            standard_deviation = round(sd(weight, na.rm = TRUE), 1),\n            sample_size = n()) \n\n# Create stats summary\nkable(bonanza_hares_weights_summary, col.names = c(\"Sex\", \"Mean Size\", \"Median\", \"Standard Deviation\", \"Sample Size\")) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n\n\n\nSex\n\n\nMean Size\n\n\nMedian\n\n\nStandard Deviation\n\n\nSample Size\n\n\nFemale\n\n\n855.4\n\n\n825\n\n\n292.3\n\n\n200\n\n\nMale\n\n\n945.9\n\n\n990\n\n\n333.2\n\n\n163\n\n\nNA\n\n\n614.5\n\n\n650\n\n\n357.6\n\n\n15\n\n\nOn average, juvenile male Snowshoe hares weigh more than juvenile female Snowshoe hares (945.86 \\(\\pm\\) 333.22 and 855.39 \\(\\pm\\) 292.25 g, respectively; mean \\(\\pm\\) 1 standard deviation). While the absolute difference in means is 90.47 g (a 10.05% difference), the difference in means is significant (Welch’s two-sample t-test: t(325.02) = 2.71, p = 0.007), and the effect size is moderate (Cohen’s d = 0.29).\nD. Relationship between juvenile Snowshoe hare weight and hind length\n\n\nhide\n\n# Clean data\nbonanza_hares_hind <- bonanza_hares %>%\n  filter (age == \"j\") %>%\n  select(weight, hindft)\n\n# Create graph\nggplot(data = bonanza_hares_hind, aes(x = weight, y = hindft)) +\n  geom_point(color = \"coral3\", fill = \"black\", size = 2) + \n  geom_smooth(method = \"lm\", color = \"gray40\") +\n  theme_minimal() +\n  labs(x = \"Weight of Hares (g)\",\n       y = \"Hind Foot Length (mm)\") +\n  theme(legend.position = c(0, 1600))\n\n\n\nhide\n\n# Do linear regression\nbonanza_hares_hind_lm <- lm(weight ~ hindft, data = bonanza_hares_hind)\n\n\n# Get tidy versions of the model output to call later on in text\nbonanza_hares_hind_lm_tidy <- tidy(bonanza_hares_hind_lm)\nbonanza_hares_lm_glance <- glance(bonanza_hares_hind_lm)\n\n# See model diagnostics:\n# plot(bonanza_hares_hind_lm)\n\n# Get Pearson's r correlation\nhares_cor <- cor.test(bonanza_hares_hind$weight, bonanza_hares_hind$hindft)\n\n# Tidy version of correlation output:\nhares_cor_tidy <- tidy(hares_cor)\n\n\n\nFigure 3: The relationship between hind foot length (mm) and weight (g) for juvenile Snowshow hares at Bonanza Creek LTER. Linear model summary: \\(\\beta\\)1 = 9.52 g mm-1, p < 0.001, R2 = 0.3, Pearson’s r = 0.55). Data: Kielland et al. (2017).\nThe relationship between juvenile snowshoe hare weight and hind foot length initially seem linear (Figure 3). Simple linear regression reveals that juvenile Snowshoe hare hind foot length does not strongly predict juvenile snowshoe hare weight (p < 0.001, R2 = 0.3) with an average slope of \\(\\beta\\) = 9.52 g mm-1 (i.e., for each millimeter increase in hind foot length we expect an average increase in weight of 9.52 g). Hind foot length and weight are moderately and positively correlated (Pearson’s r = 0.55, p < 0.001). Diagnostic plots (not included) reveal normally distributed and homoscedastic residuals. I would suspect this model would require a logarithmic regression due to its shape, but further investigation is required.\n4. Summary\nExploratory data analysis reveals the following initial findings:\nThe number of juvenile hares trapped between 1999 and 2012 has decreased significantly\nJuvenile hares weight does not vary much between males and females\nThe most data was collected on the Bonanza Riparian grid for male and female juvenile hares\nJuvenile hare weight vs hind foot length linear model summary: \\(\\beta\\)1 = 9.52 g mm-1, p < 0.001, R2 = 0.3, Pearson’s r = 0.55)\nNext steps:\nComplete multiple regression to fully understand the relationship between sex, weight, sampling site, and hind foot length.\nUpdate sampling measures to ensure data is complete and accurate.\n5. Citations\nKielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14 (Accessed 2021-11-07).\nKielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Study Sites & Design: Bonanza Creek Experimental Forest. Environmental Data Initiative. https://www.lter.uaf.edu/research/study-sites-bcef. (Accessed 2021-11-07).\nR Core Team (2021). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.\n\n\n\n",
    "preview": "portfolio/2022-02-20-juvenile-snowshoe-hares-in-bonanza-creek-experimental-forest-report/juvenile-snowshoe-hares-in-bonanza-creek-experimental-forest-report_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-02-20T18:19:38-08:00",
    "input_file": {}
  }
]
